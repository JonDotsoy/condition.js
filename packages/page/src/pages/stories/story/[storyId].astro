---
import type { GetStaticPaths } from "astro";
import Layout from "../../../layouts/Layout.astro";

interface Props {
    storyFile: string;
}

export const getStaticPaths: GetStaticPaths = async () => {
    const storiesFiles = await Astro.glob("../../../**/*.story.astro");

    return storiesFiles.map((a) => {
        return {
            params: { storyId: a.file.replace(/\W/g, "_") },
            props: {
                storyFile: a.file,
            },
        };
    });
};

const storiesFiles = await Astro.glob("../../../**/*.story.astro");
const story = storiesFiles.find((s) => s.file === Astro.props.storyFile);

if (!story) return new Response(null, { status: 404 });
---

<Layout title="Stories">
    <story.default />
</Layout>
